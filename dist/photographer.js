(()=>{"use strict";class e{static init(){const t=Array.from(document.querySelectorAll('a[href$=".jpg"], a[href$=".mp4"]')),i=t.map((e=>e.getAttribute("href"))),a=t.map((e=>e.firstElementChild.attributes.alt.value));t.forEach((t=>t.addEventListener("click",(t=>{t.preventDefault(),new e(t.currentTarget.getAttribute("href"),i,a),document.querySelector("main").setAttribute("aria-hidden","true"),document.querySelector("header").setAttribute("aria-hidden","true"),document.querySelector("footer").setAttribute("aria-hidden","true")})))),t.forEach((t=>t.addEventListener("keyup",(t=>{t.preventDefault(),"Enter"===t.key&&(new e(t.currentTarget.getAttribute("href"),i,a),document.querySelector("main").setAttribute("aria-hidden","true"),document.querySelector("header").setAttribute("aria-hidden","true"),document.querySelector("footer").setAttribute("aria-hidden","true"))}))))}constructor(e,t,i){this.element=this.buildDOM(e),this.images=t,this.titles=i,this.loadImage(e),this.onKeyUp=this.onKeyUp.bind(this),document.body.appendChild(this.element),document.addEventListener("keyup",this.onKeyUp),document.querySelector(".lightbox__close").focus()}loadImage(e){const t=Array.from(document.querySelectorAll('a[href$=".jpg"], a[href$=".mp4"]')).map((e=>e.getAttribute("href")));this.url=null;const i=document.createElement("img"),a=document.createElement("video");a.setAttribute("type","video/mp4"),a.setAttribute("controls","controls");const r=this.element.querySelector(".lightbox__container"),n=document.createElement("p");n.classList.add("lightbox__title"),n.textContent="",r.innerHTML="",this.url=e,n.textContent=this.titles[t.indexOf(e)],e.includes(".mp4")?(r.appendChild(a),a.src=e):(r.appendChild(i),i.src=e),r.appendChild(n)}onKeyUp(e){"Escape"===e.key?this.close(e):"ArrowRight"===e.key?this.next(e):"ArrowLeft"===e.key&&this.prev(e)}close(e){e.preventDefault(),this.element.classList.add("fadeOut"),window.setTimeout((()=>{this.element.parentElement.removeChild(this.element)}),500),document.removeEventListener("keyup",this.onKeyUp),document.querySelector("main").setAttribute("aria-hidden","false")}next(e){e.preventDefault();let t=this.images.findIndex((e=>e===this.url));t===this.images.length-1&&(t=-1),this.loadImage(this.images[t+1])}prev(e){e.preventDefault();let t=this.images.findIndex((e=>e===this.url));0===t&&(t=this.images.length),this.loadImage(this.images[t-1])}buildDOM(e){const t=document.createElement("div");return t.classList.add("lightbox"),t.setAttribute("role","dialog"),t.setAttribute("aria-hidden","false"),t.innerHTML='<button class="lightbox__close" aria-label="Fermer"><i  class=" fas fa-times" ></i></button>\n      <button tabindex="0" aria-label="Précédent" class="lightbox__prev"><i class="fas fa-chevron-left" ></i></button>\n      <button tabindex="0" aria-label="Suivant" class="lightbox__next"><i class="fas fa-chevron-right" ></i></button>\n      <div class="lightbox__container">\n      </div>\n      ',t.querySelector(".lightbox__close").addEventListener("click",this.close.bind(this)),t.querySelector(".lightbox__next").addEventListener("click",this.next.bind(this)),t.querySelector(".lightbox__prev").addEventListener("click",this.prev.bind(this)),t}}let t,i,a,r=[];async function n(){const e=await fetch("../FishEyeData.json");return await e.json()}n().then((e=>{t=e.photographers,i=e.media})),window.addEventListener("DOMContentLoaded",async function(){await n(),l(),t=t.filter((e=>e.id==l())),t.map((e=>s(e))),t.map((e=>d(e))),i=i.filter((e=>e.photographerId==l())),a=i,i.map((e=>c(e))),u(),m(),e.init(),b(),h()}());const l=()=>window.location.hash.substr(1),s=e=>{document.querySelector(".infoPhotographer").innerHTML+=`\n      <div class="photographer__infos">\n        <p tabindex="0" aria-label="nom du photographe"\n        class="photographer__name">${e.name}</p>\n        <p tabindex="0" aria-label=" Localisation"\n class="photographer__city">${e.city}, ${e.country}</p>\n        <p tabindex="0" aria-label="slogan"\n        class="photographer__slogan">${e.tagline}</p>\n        <div aria-label="Filtrez les photos par thème" class="photographer__tag">${o(e.tags)}</div>\n      </div>\n\n\n      <div class="photographer__btn">\n        <button class="btn contact">Contactez-moi</button>\n      </div>\n\n      \n      <div class="photographer__pp">\n        <img src="../img/IDPhotos/${e.portrait}" alt="portrait de ${e.portrait} " />\n        </div>`},o=e=>{let t="";return e.forEach((e=>{t+=`<a href="#" class="photographer__tag__filters">#${e}</a>`})),t},c=e=>{const t=document.querySelector(".pictureGallery");null==e.video?t.innerHTML+=`\n          <figure  class="cardphoto">\n          <a  tabindex="-1" href="../img/gallerie/${e.image}">\n                <img\n                tabindex="0"\n                  class="cardphoto__picture"\n                  src="../img/gallerie/${e.image} "\n                  alt="${e.title}"\n                />\n                </a>\n                <figcaption class="cardphoto__info" >\n                  <p  class="cardphoto__title">${e.title}</p>\n                  <p tabindex="0" aria-label="nombre de like " class="cardphoto__numberlike">${e.likes}</p>\n                  <i tabindex="0" role="button" aria-label="ajouter ou supprimer le like" class="cardphoto__icon fas fa-heart"></i>\n                </figcaption>\n              </figure>\n          `:t.innerHTML+=`\n          <figure class="cardphoto">\n          <a tabindex="-1" href="../img/gallerie/${e.video}">\n                <video\n                  class="cardphoto__picture"\n                  type="video/mp4"\n                  src="../img/gallerie/${e.video} "\n                  controls\n                  alt="${e.title}"\n                />\n                </a>\n                <figcaption class="cardphoto__info" >\n                  <p class="cardphoto__title">${e.title}</p>\n                  <p tabindex="0" aria-label="nombre de like" class="cardphoto__numberlike">${e.likes}</p>\n                  <i tabindex="0" role="button" aria-label="ajouter ou supprimer le like" class="cardphoto__icon fas fa-heart"></i>\n                </figcaption>\n              </figure>\n          `,r.push(e.likes),p()},d=e=>{document.querySelector("footer").innerHTML+=`\n  <div class="like">\n  <p tabindex="0" aria-label="Nombre total de like" class="like__compter"></p>\n  <i class="like__icon fas fa-heart"></i>\n  </div>\n  <div>\n  <p tabindex="0" aria-label="prix ${e.price} €/jour" class="price">${e.price}€/jour</p>\n  </div>`},u=()=>{t.map((e=>(e=>{document.body.innerHTML+=`\n  <div class="bground" aria-hidden="true" role="dialog" aria-labelby="modaltitle">\n  <div class="modal">\n    <button class="modal__close" aria-label="Fermer la modale"><i class="close fas fa-times"></i></button>\n    <div id="modaltitle" class="modal__title">\n      Contactez-moi <br />\n      ${e.name}\n    </div>\n    <form action="">\n      <label class="modal__label" for="first">Prénom</label>\n      <div class="first"></div>\n      <br />\n      <input aria-required="true" aria-invalid="false" class="modal__input" type="text" id="first" name="first" />\n      <br />\n      <label class="modal__label" for="last">Nom</label>\n      <div class="last"></div>\n      <br />\n      <input aria-required="true" aria-invalid="false" class="modal__input" type="text" id="last" name="last" />\n      <br />\n      <label class="modal__label" for="email">E-mail</label>\n      <div class="email"></div>\n      <br />\n      <input aria-required="true" aria-invalid="false" class="modal__input" type="email" id="email" name="email" />\n      <br />\n      <label class="modal__label" for="message">Votre message</label>\n      <div class="message"></div>\n      <br />\n      <textarea\n        aria-required="true" \n        aria-invalid="false"\n        class="modal__input"\n        name=""\n        id="message"\n        min = "30"\n        cols="25"\n        rows="5"\n      ></textarea>\n      <input\n        class="btn-submit"\n        type="submit"\n        class="button"\n        value="Envoyer"\n      />\n      <p class="modal__message" role="alert" aria-label="Votre message a été envoyé">Votre message a été envoyé</p>\n    </form>\n  </div>\n</div>\n  `})(e)));const e=document.querySelector(".modal__close"),i=document.querySelector(".contact"),a=document.querySelector("main");i.addEventListener("click",(()=>{const t=document.querySelector(".bground");t.style.display="initial",t.setAttribute("aria-hidden","false"),a.setAttribute("aria-hidden","true"),e.focus()})),e.addEventListener("click",(()=>{const e=document.querySelector(".bground");e.style.display="none",e.setAttribute("aria-hidden","true"),a.setAttribute("aria-hidden","false"),document.querySelector(".modal__message").style.display="none",r.reset(),g(o,m),g(c,p),g(d,b),g(u,h)})),document.addEventListener("keyup",(e=>{if("Escape"===e.key){const e=document.querySelector(".bground");e.style.display="none",e.setAttribute("aria-hidden","true"),a.setAttribute("aria-hidden","false"),document.querySelector(".modal__message").style.display="none",r.reset(),g(o,m),g(c,p),g(d,b),g(u,h)}}));const r=document.querySelector("form"),n=new RegExp(/^[a-zA-Z\-]{2,}$/i),l=new RegExp(/^[\w\_\.\-]+@[\w]+.[a-z]{2,3}$/i),s=new RegExp(/^[\w\s\D]{30,}$/i),o=document.getElementById("first"),c=document.getElementById("last"),d=document.getElementById("email"),u=document.getElementById("message"),m=document.querySelector(".first"),p=document.querySelector(".last"),b=document.querySelector(".email"),h=document.querySelector(".message");function g(e,t){e.classList.remove("error-input"),e.setAttribute("aria-invalid","false"),t.textContent=""}r.addEventListener("submit",(e=>{e.preventDefault(),1==(0!=(n.test(o.value)?(g(o,m),!0):(console.log(o.value),m.textContent="Veuillez entrer au moins deux caractères",o.classList.add("error-input"),o.setAttribute("aria-invalid","true"),o.setAttribute("role","alert"),o.setAttribute("aria-label","Veuillez entrer au moins deux caractères"),o.focus(),!1))&&0!=(n.test(c.value)?(g(c,p),!0):(p.textContent="Veuillez entrer au moins deux caractères",c.classList.add("error-input"),c.setAttribute("aria-invalid","true"),c.setAttribute("role","alert"),c.setAttribute("aria-label","Veuillez entrer au moins deux caractères"),c.focus(),!1))&&0!=(l.test(d.value)?(g(d,b),!0):(b.textContent="Veuillez entrer une adresse mail valide",d.classList.add("error-input"),d.setAttribute("aria-invalid","true"),d.setAttribute("role","alert"),d.setAttribute("aria-label","Veuillez entrer une adresse mail valide"),d.focus(),!1))&&0!=(s.test(u.value)?(g(u,h),!0):(h.textContent="Votre message doit comporter au moins 30 caractères",u.classList.add("error-input"),u.setAttribute("aria-invalid","true"),u.focus(),!1)))&&(document.querySelector(".modal__message").style.display="initial",document.querySelector(".modal__message").focus(),r.reset())}))},m=()=>{const e=document.querySelectorAll(".cardphoto__icon"),t=document.querySelector(".like__compter");e.forEach((e=>e.addEventListener("click",(()=>{e.classList.toggle("click"),e.classList.contains("click")?(e.previousElementSibling.innerText++,t.innerText++):(e.previousElementSibling.innerText--,t.innerText--)})))),e.forEach((e=>{e.addEventListener("keyup",(i=>{"Enter"===i.key&&(e.classList.toggle("click"),e.classList.contains("click")?(e.previousElementSibling.innerText++,t.innerText++):(e.previousElementSibling.innerText--,t.innerText--))}))}))},p=()=>{let e=0;for(let t=0;t<r.length;t++)e+=r[t];document.querySelector(".like__compter").innerText=e,document.querySelector(".like__compter").setAttribute("aria-label","Nombre total de like "+e)},b=()=>{const t=document.querySelector(".filterpicture__icon"),a=document.querySelector(".fa-chevron-down"),n=document.querySelector(".filterpicture__bloc"),l=document.querySelector(".pictureGallery");let s=Array.from(document.querySelectorAll(".filterpicture__link"));const o=document.querySelector(".filterpicture__select");let d,p=document.querySelector(".select");t.addEventListener("click",(()=>{n.classList.toggle("invisible"),n.setAttribute("aria-expanded","true"),a.classList.toggle("rotate"),p.classList.remove("select"),o.style.display="none"})),t.addEventListener("keyup",(e=>{"Enter"===e.key&&(n.classList.toggle("invisible"),n.setAttribute("aria-expanded","true"),a.classList.toggle("rotate"),p.classList.remove("select"),o.style.display="none")})),s.forEach((t=>t.addEventListener("click",(()=>{n.classList.add("invisible"),n.setAttribute("aria-expanded","false"),a.classList.remove("rotate"),t.classList.add("select"),o.style.display="initial";let s=document.querySelector(".select").textContent;d=t.id,o.innerText=s,r=[],"date"==d?(i.sort((function(e,t){return new Date(t.date)-new Date(e.date)})),l.innerHTML="",i.map((e=>c(e))),u(),m(),e.init(),b(),h()):"popular"==d?(i.sort((function(e,t){if(e.likes>t.likes)return-1})),l.innerHTML="",i.map((e=>c(e))),u(),m(),e.init(),b(),h()):"title"==d&&(i.sort((function(e,t){if(e.title<t.title)return-1})),l.innerHTML="",i.map((e=>c(e))),u(),m(),e.init(),b(),h())}))))};function h(){const e=document.querySelector(".pictureGallery"),t=Array.from(document.querySelectorAll(".photographer__tag__filters"));let r=null;t.forEach((n=>n.addEventListener("click",(l=>{l.preventDefault,null===r?(n.classList.add("tagselect"),r=l.target.textContent.slice(1),i=i.filter((e=>e.tags==r)),e.innerHTML="",i.map((e=>c(e)))):r===l.target.textContent.slice(1)?(n.classList.remove("tagselect"),console.log(r),i=a,e.innerHTML="",i.map((e=>c(e)))):r!=l.target.textContent.slice(1)&&(t.forEach((e=>e.classList.remove("tagselect"))),n.classList.add("tagselect"),r=l.target.textContent.slice(1),i=a,e.innerHTML="",i=i.filter((e=>e.tags==r)),i.map((e=>c(e))))}))))}})();